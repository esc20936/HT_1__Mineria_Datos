---
title: "Hoja de trabajo 1"
author: "Grupo 12"
date: "27/01/2022"
output: html_document
---

## Analisis Exploratorio

### 1. Carga de datos
```{r}
movies <- read.csv("movies.csv")
```

# Haga una exploración rápida de sus datos, para eso haga un resumen de su conjunto de datos. 
``` {r}
summary(movies)
```

## Responda las siguientes preguntas:
¿Cuáles son las 10 películas que contaron con más presupuesto?
```{r}
movies[order(movies$budget, decreasing = TRUE),c("budget","title")][1:10,]
```

¿Cuáles son las 10 películas que más ingresos tuvieron? 
```{r}
movies[order(movies$revenue, decreasing = TRUE),c("revenue","title")][1:10,]
```

¿Cuál es la película que más votos tuvo? 
```{r}
movies[order(movies$voteCount, decreasing = TRUE),c("voteCount","title")][1,]
```

¿Cuál es la peor película de acuerdo a los votos de todos los usuarios? 
```{r}
movies[order(movies$voteAvg, decreasing = FALSE),c("voteAvg","title")][1,]
```

¿Cuántas  películas  se  hicieron  en  cada  año?  ¿En  qué  año  se  hicieron  más 
películas? Haga un gráfico de barras 
```{r}
movies$releaseDate <- as.Date(movies$releaseDate)
movies$year <- format(movies$releaseDate, "%Y")
movies$year <- as.numeric(movies$year)
movies$year <- as.factor(movies$year)

moviesByYear <- table(movies$year)

barplot(moviesByYear, main = "Películas por año", xlab = "Año", ylab = "Películas", col = "blue")

```




¿Cómo se correlacionan las calificaciones con el éxito comercial? 
```{r}
cor(movies$voteAvg, movies$revenue)
```

Como podemos observar, la correlación entre las calificaciones y el éxito comercial es muy baja, por lo que podemos concluir que no existe una relación entre ambas variables.
Esto es debido a que para que exista una correlación entre dos variables, el valor de la correlación debe ser cercano a 1 o -1, y en este caso, el valor de la correlación es 0.19, lo que indica que no existe una relación entre ambas variables.

¿A qué género principal pertenecen las películas más largas? 
```{r}
movies[order(movies$runtime, decreasing = TRUE),c("runtime","genres")][1,]
```


## Preguntas extras

#### ¿A que genero pertenecen la pelicula con mejor calificacion? 
```{r}
movies[order(movies$voteAvg, decreasing = TRUE),c("voteAvg","genres","title")][1,]
```

La pelicula con mejor calificacion es "Hot Naked Sex & the City", y pertenece al genero "Comedia"

#### ¿Cuál es la pelicula con mayor cantidad de actores? 
```{r}
movies[order(movies$actorsAmount, decreasing = TRUE),c("actorsAmount","title")][1,]
```

La pelicula con mayor cantidad de actores es "Phantastische Harry Potter Momente - Das gro\xdfe SAT.1 Spezial"

#### ¿Existe una relación entre el presupuesto y las ganancias?
```{r}
cor(movies$budget, movies$revenue)
```
Es muy interesante observar que existe una relación entre el presupuesto y las ganancias, ya que el valor de la correlación es 0.73, lo que indica que existe una relación positiva entre ambas variables.
Al ser casi 1, podemos concluir que existe una relación muy fuerte entre ambas variables, ya que mientras el presupuesto sea mayor, las ganancias también lo serán.

#### ¿Cuales son las 10 peliculas con más ganancias?

<!-- get the 10 movies with bigger revenue -->
```{r}
movies[order(movies$revenue, decreasing = TRUE),c("revenue","title")][1:10,]
```

#### ¿Cual es la pelicula con más mujeres en el reparto?
```{r}
# convert to int the castWomenAmount column
movies$castWomenAmount <- suppressWarnings( as.numeric(movies$castWomenAmount))
movies[order(movies$castWomenAmount, decreasing = TRUE),c("castWomenAmount","title")][1,]
```

#### ¿Como se comporta el tiempo promedio de las peliculas por año?
```{r}
moviesByYear <- aggregate(movies$runtime, by = list(movies$year), FUN = mean)
plot(moviesByYear, type = "l", main = "Tiempo promedio de peliculas por año", xlab = "Year", ylab = "Average runtime of movies")
```

